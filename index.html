<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Catatan Keuangan</title>

    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0/dist/chartjs-plugin-datalabels.min.js"></script>
    
    <meta name="google-adsense-account" content="ca-pub-4170035550920357">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4170035550920357"
     crossorigin="anonymous"></script>
</head>

<body>

    <div class="header">
        <div class="menu-toggle" id="menuToggle">
            <i class="fas fa-bars"></i>
        </div>
        <h1>CATATAN KEUANGAN</h1>
    </div>

    <div class="side-menu-modal" id="sideMenuModal">
        <div class="side-menu-content" id="sideMenuContent">
            <div class="side-menu-header">MENU UTAMA</div>
            <div class="menu-item active" data-page="homePage">
                <i class="fas fa-home"></i> Beranda
            </div>
            <div class="menu-item" data-page="budgetKuPage">
                <i class="fas fa-wallet"></i> BudgetKu (Pengelola Keuangan)
            </div>
            <div class="menu-item" data-page="piutangPage">
                <i class="fas fa-arrow-circle-up"></i> Daftar Piutang
            </div>
            <div class="menu-item" data-page="utangPage">
                <i class="fas fa-arrow-circle-down"></i> Daftar Hutang
            </div>
            <div class="menu-item" data-page="formPage">
                <i class="fas fa-plus-circle"></i> Tambah Transaksi (Hutang/Piutang)
            </div>
            <div class="menu-item" data-page="historyPage">
                <i class="fas fa-history"></i> Riwayat (Pelunasan)
            </div>
            <div class="menu-item" data-page="summaryPage">
                <i class="fas fa-chart-pie"></i> Ringkasan (Hutang/Piutang)
            </div>
            <div class="menu-item" data-page="backupPage">
                <i class="fas fa-database"></i> Export/Import (Data)
            </div>
            <div class="menu-item" onclick="exportToCSV()">
                <i class="fas fa-file-csv"></i> Export Data (CSV)
            </div>
            <div class="menu-footer">
                Versi 1.3.2 (PWA, MOBILE, APPS)
            </div>
        </div>
    </div>

    <div class="main-content">
        
        <div class="page active" id="homePage">
             <div class="dashboard-section">
                <h2>Ringkasan Hutang/Piutang</h2>
                <div class="summary-dashboard" id="mainDashboard">
                    <p style="text-align: center; color: var(--text-muted);">Memuat...</p>
                </div>
            </div>

            <div class="dashboard-section">
                <h2>Grafik Perkembangan</h2>
                <div class="chart-container">
                    <canvas id="piutangChart"></canvas>
                </div>
            </div>

            <div class="dashboard-section">
                <h2>Transaksi</h2>
                <div id="latestTransactions">
                     <p style="text-align: center; color: var(--text-muted);">Tidak ada transaksi.</p>
                </div>
            </div>
        </div>
         
        <div class="page" id="budgetKuPage">
            <header class="budgetku-header">
                <h2><i class="fas fa-wallet"></i> BudgetKu - Kelola Uang Harian Anda</h2>
                <p>Catat semua pemasukan/pengeluaran anda di sini.</p>
            </header>
        
            <div class="saldo-box-budgetku">
                <h3>Saldo Saat Ini</h3>
                <p id="current-balance-budgetku">Rp 0</p>
            </div>
        
            <section class="transaction-form-budgetku dashboard-section">
                <h3>Tambah Transaksi Harian</h3>
                <form id="transaksi-form-budgetku">
                    <div class="form-group">
                        <label for="jumlah-budgetku">Jumlah (misal: 50000)</label>
                        <input type="number" id="jumlah-budgetku" placeholder="Hanya angka..." required>
                    </div>
                    <div class="form-group">
                        <label for="tipe-budgetku">Tipe</label>
                        <select id="tipe-budgetku" required>
                            <option value="pengeluaran">Pengeluaran</option>
                            <option value="pemasukan">Pemasukan</option>
                        </select>
                    </div>
                     <div class="form-group">
                         <label for="deskripsi-budgetku">Deskripsi</label>
                        <input type="text" id="deskripsi-budgetku" placeholder="misal: Beli Kopi" required>
                     </div>
                    <button type="submit">Tambah</button>
                </form>
            </section>
        
            <section class="transaction-list-budgetku dashboard-section">
                <h3>Riwayat Transaksi Harian</h3>
                <div class="list-controls">
                    <button id="clear-budgetku-history" style="background-color: var(--danger-color); width: 100%;"><i class="fas fa-trash-alt"></i> Hapus Semua Riwayat BudgetKu</button>
                </div>
                <ul id="riwayat-budgetku">
                </ul>
            </section>
        </div>
        
        <div class="page" id="piutangPage">
            <h2>Daftar Piutang (Meminjamkan)</h2>
            <div class="list-controls">
                 <input type="text" id="searchPiutang" placeholder="Cari nama..." onkeyup="filterTransactionList('piutang')">
                 <select id="sortPiutang" onchange="filterTransactionList('piutang')">
                     <option value="due_asc">Jatuh Tempo (Terdekat)</option>
                     <option value="amount_desc">Sisa (Terbesar)</option>
                     <option value="due_desc">Jatuh Tempo (Terjauh)</option>
                 </select>
            </div>
            <div id="piutangList">
                <p style="text-align: center; color: var(--text-muted);">Tidak ada transaksi.</p>
            </div>
        </div>
     
        <div class="page" id="utangPage">
            <h2>Daftar Hutang (Meminjam)</h2>
            <div class="list-controls">
                 <input type="text" id="searchUtang" placeholder="Cari nama..." onkeyup="filterTransactionList('utang')">
                 <select id="sortUtang" onchange="filterTransactionList('utang')">
                     <option value="due_asc">Jatuh Tempo (Terdekat)</option>
                     <option value="amount_desc">Sisa (Terbesar)</option>
                     <option value="due_desc">Jatuh Tempo (Terjauh)</option>
                 </select>
            </div>
            <div id="utangList">
                <p style="text-align: center; color: var(--text-muted);">Tidak ada transaksi.</p>
            </div>
        </div>
          
        <div class="page" id="historyPage">
            <h2>Riwayat Pelunasan (Hutang/Piutang)</h2>
            <div class="list-controls">
                 <input type="text" id="searchHistory" placeholder="Cari nama..." onkeyup="filterTransactionList('history')">
                 <select id="sortHistory" onchange="filterTransactionList('history')">
                     <option value="lunas_desc">Terbaru</option>
                     <option value="principal_desc">Terbesar</option>
                 </select>
            </div>
            <div id="historyList">
                <p style="text-align: center; color: var(--text-muted);">Tidak ada riwayat.</p>
            </div>
        </div>

        <div class="page" id="summaryPage">
            <h2>Ringkasan (Hutang & Piutang)</h2>
            <div class="summary-page-content">
                <div class="summary-block">
                    <h3>Ringkasan Piutang</h3>
                    <div class="summary-row">
                        <span>Modal Awal:</span> 
                        <strong id="summaryPiutangAwal">Rp 0</strong>
                    </div>
                    <div class="summary-row">
                        <span>Sisa Piutang Berjalan:</span> 
                        <strong style="color: var(--success-color);" id="summaryPiutangSisa">Rp 0</strong>
                    </div>
                </div>
                
                <div class="summary-block">
                    <h3>Ringkasan Hutang</h3>
                    <div class="summary-row">
                        <span>Hutang Awal:</span> 
                        <strong id="summaryUtangAwal">Rp 0</strong>
                    </div>
                    <div class="summary-row">
                        <span>Sisa Hutang Berjalan:</span> 
                        <strong style="color: var(--danger-color);" id="summaryUtangSisa">Rp 0</strong>
                    </div>
                </div>
                
                <div class="summary-block">
                    <h3>Saldo Bersih</h3>
                    <div class="summary-row networth">
                        <span>Saldo Bersih (Piutang - Hutang):</span> 
                        <strong id="summaryNetWorth">Rp 0</strong>
                    </div>
                </div>

                <button onclick="exportToCSV()" style="background-color: var(--secondary-color);">
                     <i class="fas fa-file-csv"></i> Export Data (CSV)
                </button>
            </div>
        </div>
        
        <div class="page" id="formPage">
            <h2>Tambah Transaksi (Piutang/Utang)</h2>
            <form id="transactionForm">
                <div class="form-group">
                    <label for="type"><i class="fas fa-exchange-alt"></i> Tipe Transaksi:</label>
                    <select id="type" required>
                        <option value="piutang">Piutang (Anda Meminjamkan)</option>
                        <option value="utang">Hutang (Anda Meminjam)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="person"><i class="fas fa-user"></i> Nama Orang/Pihak Kedua:</label>
                    <input type="text" id="person" required placeholder="Masukkan Nama...">
                </div>
                
                <div class="form-group">
                    <label for="principal"><i class="fas fa-coins"></i> Pokok Pinjaman (Rp):</label>
                    <input type="text" id="principal" required placeholder="Contoh: 1.000.000" oninput="formatInputRupiah(this); updateInstallmentEstimate();">
                </div>

                <div class="form-group">
                    <label for="interestRate"><i class="fas fa-percent"></i> Suku Bunga/Bulan (%):</label>
                    <input type="number" id="interestRate" required placeholder="Contoh 5" min="0" step="0.001" oninput="updateInstallmentEstimate()">
                    <div class="form-info">Tulis '0' jika tanpa bunga. Bunga dihitung dari Pokok Pinjaman.</div>
                </div>
                
                <div class="form-group">
                    <label for="installmentsCount"><i class="fas fa-calendar-alt"></i> Tenor (Bulan):</label>
                    <input type="number" id="installmentsCount" required min="1" placeholder="Contoh 12" oninput="updateInstallmentEstimate(); calculateDueDate();">
                    <div id="installmentEstimate" class="form-info" style="display: none; margin-top: 10px;"></div> 
                </div>

                <div class="form-group">
                    <label for="startDate"><i class="fas fa-calendar-day"></i> Tanggal Mulai Pinjaman:</label>
                    <input type="date" id="startDate" required onchange="calculateDueDate()">
                </div>
                
                <div class="form-group form-info">
                    <label><i class="fas fa-clock"></i> Estimasi Tanggal Jatuh Tempo Akhir:</label>
                    <strong id="finalDueDateDisplay">Pilih tanggal dan tenor cicilan.</strong>
                </div>

                <button type="submit"><i class="fas fa-save"></i> Tambah Transaksi</button>
            </form>
        </div>
         
        <div class="page" id="backupPage">
            <h2><i class="fas fa-database"></i> Export & Import Data</h2>
            
            <div class="data-section">
                <h3>Status Data Aktif</h3>
                <p><strong>Data Saat Ini:</strong></p>
                <div id="data-status">Memuat data...</div>
                <p>Simulasi data yang tersimpan (JSON format):</p>
                <pre id="current-app-data" class="mock-data"></pre>
            </div>

            <div class="backup-section">
                <h2>Pilih Export Data Atau Import Data</h2>
                <div class="info">
                    <strong>PENTING!:</strong> Fitur ini membuat file (.JSON) sebagai backup data Hutang & Piutang Anda. Data dari halaman`BudgetKu` tidak termasuk. Silahkan Export/Import sendiri pada bagian halaman tersebut.
                </div>
                <div class="button-group" style="margin-top: 15px;">
                    <button id="export-btn" class="export-btn">⬇️ Export Data</button>
                    <button id="trigger-import-btn" class="import-btn">⬆️ Import Data</button>
                    <input type="file" id="import-file" accept="application/json">
                </div>
                <p style="font-size: 0.8em; color: var(--text-muted); margin-top: 10px;">
                    File export akan tersimpan dengan format belakang file .json
                </p>
            </div>
        </div>

    </div> <div class="fab" id="fabAddTransaction" onclick="navigateTo('formPage')">
        <i class="fas fa-plus"></i>
    </div>
    
    <div id="transactionDetailModal" class="modal">
        <div class="modal-content-detail">
            <span class="close-btn" onclick="closeDetailModal()">&times;</span>
            <div class="modal-title" id="modalTitle"></div>
            <div id="modalContent"></div>
            <div class="modal-actions" id="modalActions"></div>
        </div>
    </div>
    
    <div id="paymentDateModal" class="modal">
        <div class="modal-content-payment">
            <h3>Catat Transaksi Pembayaran</h3>
            <div id="paymentAmountDisplay"></div>
            <div class="form-group" style="margin-top: 20px;">
                <label for="datePaidInput"><i class="fas fa-calendar-check"></i> Tanggal Transaksi:</label>
                <input type="date" id="datePaidInput" required>
            </div>
            
            <div class="form-group">
                <label for="nominalPaidInput"><i class="fas fa-hand-holding-usd"></i> Nominal Dibayar (Masukkan Nominal Pembayaran):</label>
                <input type="text" id="nominalPaidInput" placeholder="Masukkan jumlah bayar..." oninput="formatInputRupiah(this)">
                <div class="form-info">Jika terjadi kesalahan, ubah angka paling belakang dengan angka lebih besar (contoh: 499,333 jika tidak bisa ubah jadi 499,334 atau di bulatkan saja menjadi 500,000.</div>
            </div>

            <div class="payment-modal-actions">
                <button style="background-color: var(--secondary-color);" onclick="closePaymentModal()">Batal</button>
                <button id="confirmPaymentBtn" style="background-color: var(--success-color);">Konfirmasi</button>
            </div>
        </div>
    </div>

    <script src="script.js">
</script>

</body>
</html>
